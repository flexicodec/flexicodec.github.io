<!--
    Copyright 2018 The Distill Template Authors

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

         http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<!doctype html>

<head>
    <script src="./template.v2.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf8">
    <style>
        /* Áªü‰∏ÄÁöÑÂõæË°®Ê†áÈ¢òÊ†∑Âºè */
        figure figcaption, table caption, .table-responsive caption, .demo-caption {
            font-size: 0.9em;
            color: #666;
            margin-top: 8px;
            text-align: justify;
            hyphens: auto;
            -webkit-hyphens: auto;
            -moz-hyphens: auto;
            -ms-hyphens: auto;
            word-spacing: normal;
        }
        
        table caption, .table-responsive caption, .demo-caption {
            caption-side: bottom;
            text-align: justify;
        }
        
        /* Ê∑ªÂä†Ê≠£Êñá‰∏§Á´ØÂØπÈΩêÊ†∑Âºè */
        d-article p {
            text-align: justify;
            hyphens: auto;
            -webkit-hyphens: auto;
            -moz-hyphens: auto;
            -ms-hyphens: auto;
            word-spacing: normal; /* ÊéßÂà∂ÂçïËØçÈó¥Ë∑ù */
        }
        
        /* Ë°®Ê†ºÊ∞¥Âπ≥ÊªöÂä®Ê†∑Âºè */
        .table-responsive {
            display: block;
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            max-width: var(--body-width);
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Á°Æ‰øùË°®Ê†ºÂÜÖÂÆπ‰∏ç‰ºöË¢´ÂéãÁº© */
        .table-responsive table {
            width: auto;
            min-width: 100%;
        }
        
        /* Á°Æ‰øùÈü≥È¢ëÊéß‰ª∂ÊúâÂõ∫ÂÆöÂÆΩÂ∫¶ */
        audio {
            width: 140px !important;
        }
        
        /* Á°Æ‰øùË°®Ê†º‰∏≠ÁöÑÊñáÊú¨Ê≤°ÊúâÂ§ö‰ΩôÁöÑÁ©∫Ê†º */
        td strong, th strong {
            padding: 0;
            margin: 0;
            display: inline-block;
        }
        
        /* Èü≥È¢ëË°®Ê†ºÊ†∑Âºè */
        .audio-comparison-table td {
            padding: 10px 5px !important;
            vertical-align: middle !important;
        }
        
        .audio-comparison-table td:first-child {
            min-width: 150px !important;
        }
        
        .audio-comparison-table audio {
            margin: 0px;
            display: block;
            margin: 0 auto;
        }
        
        /* Sticky first column for TTS demo table */
        #demo-tts-general {
            position: relative;
        }
        
        #demo-tts-general table {
            border-collapse: separate;
            border-spacing: 0;
        }
        
        #demo-tts-general th:first-child,
        #demo-tts-general td:first-child {
            position: sticky;
            left: 0;
            z-index: 2;
            background-color: #ffffff;
            border-right: 2px solid #dee2e6;
            box-shadow: 2px 0 4px rgba(0,0,0,0.1);
        }
        
        #demo-tts-general th:first-child {
            z-index: 3;
            background-color: #f8f9fa;
        }
        
        /* Ë°®Ê†ºÊñáÂ≠óÂ±Ö‰∏≠Ê†∑Âºè */
        .table td, .table th {
            text-align: center;
            vertical-align: middle;
        }
        
        /* ÁºñËß£Á†ÅÂô®ÊØîËæÉË°®Ê†ºÊ†∑Âºè */
        #table-codec-comparison .table td:first-child {
            min-width: 140px;
            font-weight: 500;
        }
        
        /* Horizontally scrollable table container */
        #table-tokenization-comparison {
            width: 100% !important;
            max-width: 100% !important;
            margin: 20px auto !important;
            overflow-x: auto;
            overflow-y: visible;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        #table-tokenization-comparison table {
            width: auto !important;        /* Let table determine its own width */
            min-width: 600px;             /* Further reduced minimum width */
            border-collapse: collapse;
            table-layout: auto !important; /* Auto layout for proper column sizing */
            font-size: 0.6rem;            /* Much smaller font size */
            line-height: 1.1;             /* Even tighter line height */
            margin: 0 !important;
        }
        
        #table-tokenization-comparison th,
        #table-tokenization-comparison td {
            padding: 5px 8px !important;   /* Reduced padding */
            vertical-align: middle;
            border: 1px solid #e0e0e0;
            white-space: nowrap;           /* Prevent all text wrapping */
            text-align: center;
        }
        
        #table-tokenization-comparison th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #333;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        /* Specific column widths for better spacing */
        #table-tokenization-comparison th:nth-child(1),
        #table-tokenization-comparison td:nth-child(1) {
            min-width: 110px;            /* Reduced Method column width */
            text-align: left;
            background-color: #f4f4f4;   /* Light gray background for method names */
        }
        
        #table-tokenization-comparison th:nth-child(2),
        #table-tokenization-comparison td:nth-child(2) {
            min-width: 80px;             /* Reduced Frame Rate column width */
        }
        
        #table-tokenization-comparison th:nth-child(3),
        #table-tokenization-comparison td:nth-child(3) {
            min-width: 70px;             /* Reduced Dynamic Rate column width */
        }
        
        #table-tokenization-comparison th:nth-child(4),
        #table-tokenization-comparison td:nth-child(4) {
            min-width: 160px;            /* Reduced Controllable Rate column width */
        }
        
        #table-tokenization-comparison th:nth-child(5),
        #table-tokenization-comparison td:nth-child(5) {
            min-width: 140px;            /* Reduced Semantic Augmentation column width */
        }
        
        #table-tokenization-comparison th:nth-child(6),
        #table-tokenization-comparison td:nth-child(6) {
            min-width: 80px;             /* Reduced Has TTS Results column width */
        }
        
        /* FlexiCodec row highlight - target the row with border-top */
        #table-tokenization-comparison tr[style*="border-top"] td {
            background-color: #e8f4f8;
            font-weight: 500;
        }
        
        /* Override first column background for FlexiCodec row */
        #table-tokenization-comparison tr[style*="border-top"] td:nth-child(1) {
            background-color: #e8f4f8;
        }
        
        /* Scroll hint shadow */
        #table-tokenization-comparison::after {
            content: '‚Üê Scroll horizontally ‚Üí';
            position: absolute;
            bottom: 5px;
            right: 10px;
            font-size: 0.75rem;
            color: #666;
            opacity: 0.7;
            pointer-events: none;
        }
        
        /* Responsive styling for TTS demo table */
        #demo-tts-general {
            overflow-x: auto;
        }
        
        #demo-tts-general audio {
            width: 140px;
            height: 32px;
            min-width: 100px;
        }
        
        /* Responsive adjustments for smaller screens */
        @media (max-width: 768px) {
            #demo-tts-general audio {
                width: 100px;
                height: 28px;
                min-width: 80px;
            }
            
            #demo-tts-general th,
            #demo-tts-general td {
                font-size: 0.8rem;
                padding: 4px;
            }
            
            #demo-tts-general th:first-child,
            #demo-tts-general td:first-child {
                min-width: 120px;
            }
        }
        
        @media (max-width: 480px) {
            #demo-tts-general audio {
                width: 80px;
                height: 24px;
                min-width: 70px;
            }
            
            #demo-tts-general th,
            #demo-tts-general td {
                font-size: 0.7rem;
                padding: 2px;
            }
            
            #demo-tts-general th:first-child,
            #demo-tts-general td:first-child {
                min-width: 100px;
            }
        }
        
        /* Responsive styling for frame rate comparison tables */
        @media (max-width: 768px) {
            .frame-rate-table audio {
                width: 100px !important;
                height: 28px !important;
            }
            
            .frame-rate-table th,
            .frame-rate-table td {
                font-size: 0.8rem !important;
                padding: 4px !important;
            }
        }
        
        @media (max-width: 480px) {
            .frame-rate-table audio {
                width: 80px !important;
                height: 24px !important;
            }
            
            .frame-rate-table th,
            .frame-rate-table td {
                font-size: 0.7rem !important;
                padding: 2px !important;
            }
            
            .frame-rate-table th:first-child,
            .frame-rate-table td:first-child {
                min-width: 80px !important;
            }
        }
        
        /* Codec comparison table scrollable styling */
        #table-codec-comparison {
            width: 100% !important;
            max-width: 100% !important;
            margin: 20px auto !important;
            overflow-x: auto;
            overflow-y: visible;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: relative;
        }
        
        #table-codec-comparison table {
            width: auto !important;
            min-width: 1200px;
            border-collapse: separate;
            border-spacing: 0;
            table-layout: auto !important;
            font-size: 0.85rem;
            line-height: 1.2;
            margin: 0 !important;
        }
        
        #table-codec-comparison th,
        #table-codec-comparison td {
            padding: 6px 8px !important;
            vertical-align: middle;
            border: 1px solid #e0e0e0;
            white-space: nowrap;
            text-align: center;
        }
        
        #table-codec-comparison th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #333;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        /* Fixed first column (System) */
        #table-codec-comparison th:first-child,
        #table-codec-comparison td:first-child {
            position: sticky;
            left: 0;
            z-index: 5;
            background-color: #ffffff;
            border-right: 2px solid #dee2e6;
            box-shadow: 2px 0 4px rgba(0,0,0,0.1);
            min-width: 180px;
            max-width: 180px;
            text-align: left;
        }
        
        #table-codec-comparison th:first-child {
            z-index: 15;
            background-color: #f8f9fa;
        }
        
        /* Category separator rows */
        #table-codec-comparison td[colspan] {
            position: sticky;
            left: 0;
            z-index: 6;
            background-color: #f0f0f0;
            box-shadow: none;
        }
        
        /* Responsive adjustments */
        @media (max-width: 1024px) {
            #table-codec-comparison table {
                font-size: 0.8rem;
            }
            
            #table-codec-comparison th,
            #table-codec-comparison td {
                padding: 4px 6px !important;
            }
        }
        
        @media (max-width: 768px) {
            #table-codec-comparison table {
                font-size: 0.75rem;
                min-width: 1000px;
            }
            
            #table-codec-comparison th:first-child,
            #table-codec-comparison td:first-child {
                min-width: 140px;
                max-width: 140px;
            }
        }
        

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        
        /* Override Distill template constraints for better desktop utilization */
        @media (min-width: 1024px) {
            d-article {
                max-width: 1400px !important;
                margin: 0 auto;
                padding: 0 40px;
            }
            
            .table-responsive {
                max-width: 100% !important;
            }
        }
        
        @media (min-width: 1200px) {
            d-article {
                max-width: 1600px !important;
                padding: 0 60px;
            }
        }
        
        @media (min-width: 1400px) {
            d-article {
                max-width: 1800px !important;
                padding: 0 80px;
            }
        }
        
        /* Maintain mobile responsiveness */
        @media (max-width: 1023px) {
            d-article {
                padding: 0 20px;
            }
        }

    </style>
    <script>
        // Âú®ÊñáÊ°£Âä†ËΩΩÂÆåÊàêÂêéÊâßË°å
        document.addEventListener('DOMContentLoaded', function() {
            // Ëé∑ÂèñÊâÄÊúâtable-caption divÂÖÉÁ¥†
            const tableCaptions = document.querySelectorAll('.table-caption');
            // ‰∏∫ÊØè‰∏™captionÊ∑ªÂä†Ë°®Ê†ºÁºñÂè∑
            tableCaptions.forEach((caption, index) => {
                const tableNum = index + 1;
                const captionText = caption.innerHTML;
                // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÊúâTable X:Ê†ºÂºèÁöÑÊ†áÈ¢ò
                if (!captionText.match(/^<strong>Table \d+:<\/strong>/)) {
                    caption.innerHTML = `<strong>Table ${tableNum}:</strong> ` + captionText.replace(/^<strong>Table \d+:<\/strong>\s*/, '');
                }
            });
            
            // Ëé∑ÂèñÊâÄÊúâfigureÁöÑfigcaption
            const figcaptions = document.querySelectorAll('figure figcaption');
            // ‰∏∫ÊØè‰∏™figcaptionÊ∑ªÂä†ÂõæÁâáÁºñÂè∑
            figcaptions.forEach((figcaption, index) => {
                const figNum = index + 1;
                const figcaptionText = figcaption.innerHTML;
                // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÊúâFigure X:Ê†ºÂºèÁöÑÊ†áÈ¢ò
                if (!figcaptionText.match(/^<strong>Figure \d+:<\/strong>/)) {
                    figcaption.innerHTML = `<strong>Figure ${figNum}:</strong> ` + figcaptionText.replace(/^<strong>Figure \d+:<\/strong>\s*/, '');
                }
            });
            
            // Ëé∑ÂèñÊâÄÊúâdemoË°®Ê†ºÁöÑcaption (Âè™Â§ÑÁêÜdemo-captionÁ±ª)
            const demoCaptions = document.querySelectorAll('.demo-caption');
            // ‰∏∫ÊØè‰∏™demo captionÊ∑ªÂä†ÁºñÂè∑
            demoCaptions.forEach((caption, index) => {
                const demoNum = index + 1;
                const captionText = caption.innerHTML;
                // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÊúâDemo X:Ê†ºÂºèÁöÑÊ†áÈ¢ò
                if (!captionText.match(/^<strong>Demo \d+:<\/strong>/)) {
                    caption.innerHTML = `<strong>Demo ${demoNum}:</strong> ` + captionText.replace(/^<strong>Demo \d+:<\/strong>\s*/, '');
                }
            });
            
            // Â§ÑÁêÜÂºïÁî®ÈìæÊé•
            function updateReferences() {
                // Â§ÑÁêÜÂõæÁâáÂºïÁî® - Ëé∑ÂèñÊâÄÊúâfigureÂÖÉÁ¥†Ôºå‰∏ç‰ªÖ‰ªÖÊòØÂ∏¶ÊúâIDÁöÑ
                const allFigures = document.querySelectorAll('figure');
                const figureRefs = document.querySelectorAll('a.fig-ref');
                
                // ÂàõÂª∫IDÂà∞Á¥¢ÂºïÁöÑÊò†Â∞Ñ
                const figureIdToIndex = {};
                allFigures.forEach((figure, index) => {
                    if (figure.id) {
                        figureIdToIndex[figure.id] = index + 1; // ÁºñÂè∑‰ªé1ÂºÄÂßã
                    }
                });
                
                // Êõ¥Êñ∞ÂºïÁî®
                figureRefs.forEach(ref => {
                    const targetId = ref.getAttribute('href').substring(1); // ÁßªÈô§ÂºÄÂ§¥ÁöÑ#
                    if (figureIdToIndex[targetId]) {
                        ref.innerHTML = ref.innerHTML.replace(/Figure X/, `Figure ${figureIdToIndex[targetId]}`);
                    }
                });
                
                // Â§ÑÁêÜË°®Ê†ºÂºïÁî®
                const tables = document.querySelectorAll('table[id]');
                const tableRefs = document.querySelectorAll('a.table-ref');
                
                tables.forEach((table, index) => {
                    const tableNum = index + 1;
                    const tableId = table.id;
                    
                    // Êõ¥Êñ∞ÂºïÁî®Ëøô‰∏™Ë°®Ê†ºÁöÑÈìæÊé•ÊñáÊú¨
                    tableRefs.forEach(ref => {
                        if (ref.getAttribute('href') === `#${tableId}`) {
                            ref.innerHTML = ref.innerHTML.replace(/Table X/, `Table ${tableNum}`);
                        }
                    });
                });
                
                // Â§ÑÁêÜÊºîÁ§∫ÂºïÁî®
                const demos = document.querySelectorAll('.table-responsive[id]');
                const demoRefs = document.querySelectorAll('a.demo-ref');
                
                demos.forEach((demo, index) => {
                    const demoNum = index + 1;
                    const demoId = demo.id;
                    
                    // Êõ¥Êñ∞ÂºïÁî®Ëøô‰∏™ÊºîÁ§∫ÁöÑÈìæÊé•ÊñáÊú¨
                    demoRefs.forEach(ref => {
                        if (ref.getAttribute('href') === `#${demoId}`) {
                            ref.innerHTML = ref.innerHTML.replace(/Demo X/, `Demo ${demoNum}`);
                        }
                    });
                });
            }
            
            // ÊâßË°åÂºïÁî®Êõ¥Êñ∞
            updateReferences();
        });
        
        // Toggle function for reference text row
        function toggleReferenceText() {
            const textRow = document.getElementById('reference-text-row');
            const button = document.getElementById('toggle-text-btn');
            
            if (textRow.style.display === 'none') {
                textRow.style.display = 'table-row';
                button.innerHTML = 'üìù Hide Reference Text';
                button.style.backgroundColor = '#dc3545';
            } else {
                textRow.style.display = 'none';
                button.innerHTML = 'üìù Show Reference Text';
                button.style.backgroundColor = '#007bff';
            }
        }
        
        // Toggle function for frame rate reference text row
        function toggleFrameRateText() {
            const textRow = document.getElementById('frame-rate-text-row');
            const button = document.getElementById('toggle-frame-rate-text-btn');
            
            if (textRow.style.display === 'none') {
                textRow.style.display = 'table-row';
                button.innerHTML = 'üìù Hide Reference Text';
                button.style.backgroundColor = '#dc3545';
            } else {
                textRow.style.display = 'none';
                button.innerHTML = 'üìù Show Reference Text';
                button.style.backgroundColor = '#007bff';
            }
        }
        
        // Toggle function for threshold reference text row
        function toggleThresholdReferenceText() {
            const textRow = document.getElementById('threshold-reference-text-row');
            const button = document.getElementById('toggle-threshold-text-btn');
            
            if (textRow.style.display === 'none') {
                textRow.style.display = 'table-row';
                button.innerHTML = 'üìù Hide Reference Text';
                button.style.backgroundColor = '#dc3545';
            } else {
                textRow.style.display = 'none';
                button.innerHTML = 'üìù Show Reference Text';
                button.style.backgroundColor = '#007bff';
            }
        }
        
        // Reference texts for different samples
        const frameRateTexts = {
            1: "if you will give us your promise to meet captain battleax here at this time to morrow we will stretch a point and delay the departure of the john bright for twenty four hours",
            2: "but as we descend the social scale the point is presently reached where the duties of vicarious leisure and consumption devolve upon the wife alone",
            3: "well now ennis i declare you have a head and so has my stick",
            4: "how brown you've got since you came home i wish i had an athlete to mow my orchard",
            5: "the strange woman and her passionate sentence that rang out so sharply had frightened them both",
            6: "not a doubt but had your force been only double or treble our own i should have found it my duty to struggle with you",
            7: "why you said to fetch the first living creature we met and that was this billygoat replied the captain panting hard as he held fast to one of the goat's horns",
            8: "in a general way though not wholly nor consistently these two groups coincide",
            9: "the stop at queenstown the tedious passage up the mersey were things that he noted dimly through his growing impatience",
            10: "the phrase and the day and the scene harmonized in a chord"
        };
        
        // Function to switch between different audio samples in frame rate comparison
        function switchSample(sampleNumber) {
            // Update button styles
            document.querySelectorAll('.sample-btn').forEach(btn => {
                btn.style.backgroundColor = 'transparent';
                btn.style.color = '#666';
                btn.classList.remove('active');
            });
            
            const activeBtn = document.querySelector(`[onclick="switchSample(${sampleNumber})"]`);
            activeBtn.style.backgroundColor = '#4285f4';
            activeBtn.style.color = 'white';
            activeBtn.classList.add('active');
            
            // Update audio sources - format sample number as 5-digit string (e.g., 00000, 00001)
            const paddedSample = (sampleNumber - 1).toString().padStart(5, '0');
            
            // Update all audio elements
            document.querySelectorAll('.sample-audio').forEach(audio => {
                const source = audio.querySelector('source');
                if (source && source.src) {
                    // Replace the filename part with the new sample number, keeping the queue suffix (_1q or _0q)
                    source.src = source.src.replace(/\d{5}_[01]q\.wav$/, `${paddedSample}_${source.src.match(/_([01])q\.wav$/)[1]}q.wav`);
                    audio.load(); // Reload the audio element with new source
                }
            });
            
            // Update reference text
            const referenceText = frameRateTexts[sampleNumber] || "";
            document.getElementById('text-6hz').textContent = referenceText;
        }
        
        // Toggle function for 8Q frame rate reference text row
        function toggleFrameRate8QText() {
            const textRow = document.getElementById('frame-rate-8q-text-row');
            const button = document.getElementById('toggle-frame-rate-8q-text-btn');
            
            if (textRow.style.display === 'none') {
                textRow.style.display = 'table-row';
                button.innerHTML = 'üìù Hide Reference Text';
                button.style.backgroundColor = '#dc3545';
            } else {
                textRow.style.display = 'none';
                button.innerHTML = 'üìù Show Reference Text';
                button.style.backgroundColor = '#007bff';
            }
        }
        
        // Function to switch between different audio samples in 8Q frame rate comparison
        function switch8QSample(sampleNumber) {
            // Update button styles
            document.querySelectorAll('.sample-8q-btn').forEach(btn => {
                btn.style.backgroundColor = 'transparent';
                btn.style.color = '#666';
                btn.classList.remove('active');
            });
            
            const activeBtn = document.querySelector(`[onclick="switch8QSample(${sampleNumber})"]`);
            activeBtn.style.backgroundColor = '#4285f4';
            activeBtn.style.color = 'white';
            activeBtn.classList.add('active');
            
            // Update audio sources - format sample number as 5-digit string (e.g., 00000, 00001)
            const paddedSample = (sampleNumber - 1).toString().padStart(5, '0');
            
            // Update all audio elements
            document.querySelectorAll('.sample-8q-audio').forEach(audio => {
                const source = audio.querySelector('source');
                if (source && source.src) {
                    // Replace the filename part with the new sample number, keeping _8q suffix
                    source.src = source.src.replace(/\d{5}_[08]q\.wav$/, `${paddedSample}_${source.src.match(/_([08])q\.wav$/)[1]}q.wav`);
                    audio.load(); // Reload the audio element with new source
                }
            });
            
            // Update reference text
            const referenceText = frameRateTexts[sampleNumber] || "";
            document.getElementById('text-8q-6hz').textContent = referenceText;
        }
        
        // Toggle function for codec comparison reference text row
        function toggleCodecComparisonText() {
            const textRow = document.getElementById('codec-comparison-text-row');
            const button = document.getElementById('toggle-codec-comparison-text-btn');
            
            if (textRow.style.display === 'none') {
                textRow.style.display = 'table-row';
                button.innerHTML = 'üìù Hide Reference Text';
                button.style.backgroundColor = '#dc3545';
            } else {
                textRow.style.display = 'none';
                button.innerHTML = 'üìù Show Reference Text';
                button.style.backgroundColor = '#007bff';
            }
        }
        
        // Function to switch between different audio samples in codec comparison
        function switchCodecSample(sampleNumber) {
            // Update button styles
            document.querySelectorAll('.codec-sample-btn').forEach(btn => {
                btn.style.backgroundColor = 'transparent';
                btn.style.color = '#666';
                btn.classList.remove('active');
            });
            
            const activeBtn = document.querySelector(`[onclick="switchCodecSample(${sampleNumber})"]`);
            activeBtn.style.backgroundColor = '#4285f4';
            activeBtn.style.color = 'white';
            activeBtn.classList.add('active');
            
            // Update audio sources - format sample number as 5-digit string (e.g., 00000, 00001)
            const paddedSample = (sampleNumber - 1).toString().padStart(5, '0');
            
            // Update all audio elements
            document.querySelectorAll('.codec-sample-audio').forEach(audio => {
                const source = audio.querySelector('source');
                if (source && source.src) {
                    // Replace the filename part with the new sample number
                    source.src = source.src.replace(/\d{5}(_[0128]q)?\.wav$/, `${paddedSample}$1.wav`);
                    audio.load(); // Reload the audio element with new source
                }
            });
            
            // Update reference text
            const referenceText = frameRateTexts[sampleNumber] || "";
            document.getElementById('codec-comparison-text').textContent = referenceText;
        }
        
        // Function to switch between different audio samples in threshold analysis
        function switchThresholdSample(sampleNumber) {
            // Update button styles
            document.querySelectorAll('.threshold-sample-btn').forEach(btn => {
                btn.style.backgroundColor = 'transparent';
                btn.style.color = '#6c757d';
                btn.style.borderColor = '#6c757d';
                btn.classList.remove('active');
            });
            
            const activeBtn = document.querySelector(`[onclick="switchThresholdSample(${sampleNumber})"]`);
            activeBtn.style.backgroundColor = '#007bff';
            activeBtn.style.color = 'white';
            activeBtn.style.borderColor = '#007bff';
            activeBtn.classList.add('active');
            
            // Update audio sources - format sample number as 5-digit string (e.g., 00000, 00001)
            const paddedSample = sampleNumber.toString().padStart(5, '0');
            
            // Update all threshold audio elements
            document.querySelectorAll('.threshold-sample-audio').forEach(audio => {
                const source = audio.querySelector('source');
                if (source && source.src) {
                    // Replace the filename part with the new sample number
                    source.src = source.src.replace(/\d{5}(_[01]q)?\.wav$/, `${paddedSample}$1.wav`);
                    audio.load(); // Reload the audio element with new source
                }
            });
        }
    </script>
</head>

<body>
    <!-- <d-front-matter>
        <script id='distill-front-matter' type="text/json">{
        "title": "",
        "published": "",
        "authors": [],
        "katex": {
            "delimiters": [
                {"left": "$$", "right": "$$", "display": false}
            ]
        }
        }</script>
    </d-front-matter> -->
    
    <!-- Navigation Bar -->
    <nav class="navbar" style="background-color: #f8f9fa; padding: 15px 0; border-bottom: 1px solid #dee2e6;">
        <div style="max-width: 1600px; margin: 0 auto; padding: 0 40px;">
            <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 20px;">
                <a href="#abstract" style="color: #495057; text-decoration: none; font-weight: 500; padding: 8px 12px; border-radius: 4px; transition: background-color 0.2s;">Abstract</a>
                <a href="#method" style="color: #495057; text-decoration: none; font-weight: 500; padding: 8px 12px; border-radius: 4px; transition: background-color 0.2s;">Method</a>
                <a href="#semantic-evaluation" style="color: #495057; text-decoration: none; font-weight: 500; padding: 8px 12px; border-radius: 4px; transition: background-color 0.2s;">Semantic Evaluation</a>
                <a href="#speech-codec-comparison" style="color: #495057; text-decoration: none; font-weight: 500; padding: 8px 12px; border-radius: 4px; transition: background-color 0.2s;">Speech Codec Comparison</a>
                <a href="#demo-tts-general" style="color: #495057; text-decoration: none; font-weight: 500; padding: 8px 12px; border-radius: 4px; transition: background-color 0.2s;">TTS</a>
                <a href="#frame-rate-controllability" style="color: #495057; text-decoration: none; font-weight: 500; padding: 8px 12px; border-radius: 4px; transition: background-color 0.2s;">Frame Rate Controllability</a>
            </div>
        </div>
    </nav>
    
    <style>
        .navbar a:hover {
            background-color: #e9ecef;
        }
        .navbar a:active {
            background-color: #dee2e6;
        }
    </style>
    
    <!-- Title Section -->
    <div style="text-align: center; padding: 40px 20px; background-color: #ffffff;">
        <h1 style="font-size: 2.5em; font-weight: 600; color: #2c3e50; margin: 0; line-height: 1.2; max-width: 1400px; margin-left: auto; margin-right: auto;">
            FlexiCodec: A Dynamic Neural Audio Codec for Low Frame Rates
        </h1>
    </div>
    
    <d-article>
        <figure style="margin: 20px 0; width: 100%; max-width: none;">
            <img src="flexicodec_architetcure.png" alt="Architecture of FlexiCodec" style="width: 100%; height: auto; max-width: none; border: 1px solid #ddd; border-radius: 8px;">
            <figcaption style="margin-top: 10px; text-align: center; max-width: 900px; margin-left: auto; margin-right: auto;">
                Architecture of <strong>FlexiCodec</strong>. The model employs dynamic frame rates and an ASR feature-assisted dual-stream encoder, and supports a controllable frame rate between 3Hz and 12.5Hz.
            </figcaption>
        </figure>


        <h2 id="abstract">Abstract</h2>
            <p>
                Neural audio codecs are foundational to speech language models. It is expected to have a low frame rate and decoupled semantic and acoustic information. A lower frame rate codec can reduce the computational cost of speech language models by shortening the sequence length. Recent studies have developed 12.5Hz low-frame-rate audio codecs, but even lower frame rate codecs remain underexplored. We find that a major challenge for very low frame rate tokens is missing semantic information. This paper introduces <strong>FlexiCodec</strong> to address this limitation. FlexiCodec improves semantic preservation with a <strong>dynamic frame rate</strong> approach and introduces a novel architecture featuring an <strong>ASR feature-assisted dual stream</strong> encoding and Transformer bottlenecks. With dynamic frame rates, it uses less frames at information-sparse regions through adaptively merging semantically similar frames. A dynamic frame rate also allows FlexiCodec to support inference-time <strong>controllable frame rates</strong> between 3Hz and 12.5Hz. Experiments on <strong>6.25Hz, 8.3Hz and 12.5Hz</strong> average frame rates confirm that FlexiCodec excels over baseline systems in semantic information preservation and delivers a high audio reconstruction quality. We also validate the effectiveness of FlexiCodec in language model-based TTS.
            </p>
        <h2 id="method">Method</h2>
        Our motivation was to explore very low frame rate neural audio codecs. A very low frame rate codec is beneficial for the downstream tasks efficiency.
        Our final system, FlexiCodec is a novel low-frame-rate codec built on three design choices:
            (1) Dynamic frame rate,
            (2) Rich semantics guided by ASR feature, and 
            (3) Frame rate control ability. 
            This allows our codec system to support very low frame rate, and A controllable frame rate supports versatile efficiency-performance tradeoff demands.
            A general comparison between different audio tokenization methods is shown in the table below.
        <div class="table-responsive" id="table-tokenization-comparison">
            <table>
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Frame Rate (Hz)</th>
                        <th>Dynamic Rate</th>
                        <th>Controllable Rate</th>
                        <th>Semantic Augmentation</th>
                        <th>Has TTS Results?</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>DAC</strong></td>
                        <td>75</td>
                        <td>‚úó</td>
                        <td>‚úó</td>
                        <td>‚úó</td>
                        <td>‚úó</td>
                    </tr>
                    <tr>
                        <td><strong>SpeechTokenizer</strong></td>
                        <td>50</td>
                        <td>‚úó</td>
                        <td>‚úó</td>
                        <td>SSL feature (HuBERT)</td>
                        <td>‚úì</td>
                    </tr>
                    <tr>
                        <td><strong>CodecSlime</strong></td>
                        <td>40 (Avg)</td>
                        <td>‚úì</td>
                        <td>‚úì (40,50,67,80Hz options)</td>
                        <td>‚úó</td>
                        <td>‚úó</td>
                    </tr>
                    <tr>
                        <td><strong>Mimi</strong></td>
                        <td>12.5</td>
                        <td>‚úó</td>
                        <td>‚úó</td>
                        <td>SSL feature (WavLM)</td>
                        <td>‚úì</td>
                    </tr>
                    <tr>
                        <td><strong>DualCodec</strong></td>
                        <td>12.5/25</td>
                        <td>‚úó</td>
                        <td>‚úó</td>
                        <td>SSL feature (w2v-bert-2)</td>
                        <td>‚úì</td>
                    </tr>
                    <tr>
                        <td><strong>TaDiCodec</strong></td>
                        <td>6.25</td>
                        <td>‚úó</td>
                        <td>‚úó</td>
                        <td>Text</td>
                        <td>‚úì</td>
                    </tr>
                    <tr>
                        <td><strong>Phoneme Tokens</strong></td>
                        <td>11.7 (Avg)</td>
                        <td>‚úì</td>
                        <td>‚úó</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td><strong>BPE Text Tokens</strong></td>
                        <td>4.5 (Avg)</td>
                        <td>‚úì</td>
                        <td>‚úó</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                    <tr style="border-top: 2px solid #000;">
                        <td><strong>FlexiCodec</strong></td>
                        <td><strong>6.25/8.3/12.5 (Avg)</strong></td>
                        <td><strong>‚úì</strong></td>
                        <td><strong>‚úì (Any from 3 to 12.5Hz)</strong></td>
                        <td><strong>ASR feature</strong></td>
                        <td><strong>‚úì</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="table-caption" style="margin-top: 10px; font-size: 0.9em; color: #666; text-align: justify;">
                Comparison of different audio tokenization methods and their properties.
        </div>

        <div><br>
        The following figure shows a zoomed-in view of the frame merging and unmerging module, which enables dynamic frame rate.
        Each has a transformer inside. 
        A merging "threshold" parameter controls the intensity of frame merging. 
        A lower threshold results in a lower <i>average</i> frame rate (we can only report "average" frame rate because the frame rate is not fixed).
        During inference, users can select from a threshold from 0.7 to 1.0, to use a frame rate (3.0 to 12.5Hz) they want.
        In the following sections, we provide demo audios for our experiments.
            </div>
        <figure style="text-align: center; margin: 30px 0;">
            <img src="mergingunmerging_architecture.png" alt="FlexiCodec merging and unmerging architecture" style="max-width: 95%; height: auto; border: 1px solid #ddd; border-radius: 8px;">
            <figcaption style="margin-top: 10px; font-size: 0.9em; color: #666; text-align: center; max-width: 800px; margin-left: auto; margin-right: auto;">
                The system adaptively merges semantically similar frames during encoding and reconstructs the original temporal resolution during decoding.
                    </figcaption>
                </figure>

        

            <h2 id="preliminary-experiments">Examining the impact of very low frame rates</h2>
            <p>
                We first investigate the performance of representative audio codecs at very low frame rates. 
                We created three new baseline versions by retraining DAC and DualCodec to operate at 12.5Hz, 8.3Hz, and 6.25Hz, respectively. 
            </p>
            
            <h3 id="semantic-evaluation">Semantic Information Preservation</h3>
            <p>
                The following audios are the codec-reconstructed audios using their RVQ-1 tokens.
                For these RVQ-1 audios, we focus on their intelligibility instead of the acoustic details, because at such low frame rate and bitrate, it is not possible to reconstruct the acoustic details, but we can maintain the core semantic information that are 
                useful for downstream models.
            </p>
            <!-- <div style="margin-bottom: 10px; text-align: center;">
                <button id="toggle-frame-rate-text-btn" onclick="toggleFrameRateText()" style="padding: 8px 16px; background-color: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9rem; margin-bottom: 10px;">
                    üìù Hide Reference Text
                </button>
            </div> -->
            
            <div style="margin-bottom: 15px; text-align: center;">
                <div style="display: inline-flex; flex-wrap: wrap; justify-content: center; background-color: #f8f9fa; border-radius: 6px; padding: 3px; gap: 1px;">
                    <button class="sample-btn active" onclick="switchSample(1)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: #4285f4; color: white; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 1</button>
                    <button class="sample-btn" onclick="switchSample(2)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 2</button>
                    <button class="sample-btn" onclick="switchSample(3)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 3</button>
                    <button class="sample-btn" onclick="switchSample(4)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 4</button>
                    <button class="sample-btn" onclick="switchSample(5)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 5</button>
                    <button class="sample-btn" onclick="switchSample(6)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 6</button>
                    <button class="sample-btn" onclick="switchSample(7)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 7</button>
                    <button class="sample-btn" onclick="switchSample(8)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 8</button>
                    <button class="sample-btn" onclick="switchSample(9)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 9</button>
                    <button class="sample-btn" onclick="switchSample(10)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 10</button>
                </div>
            </div>
            <div class="table-responsive" id="frame-rate-comparison">
                <table class="frame-rate-table" style="width: 100%; border-collapse: collapse; margin: 10px 0;">
                    <thead>
                        <tr>
                            <th style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: 600; min-width: 100px; font-size: 0.9rem;">Model</th>
                            <th style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: 600; min-width: 160px; font-size: 0.9rem;">6.25Hz (RVQ1)</th>
                            <th style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: 600; min-width: 160px; font-size: 0.9rem;">8.3Hz (RVQ1)</th>
                            <th style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: 600; min-width: 160px; font-size: 0.9rem;">12.5Hz (RVQ1)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="frame-rate-text-row" style="display: table-row;">
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">Reference Text</td>
                            <td colspan="3" style="border: 1px solid #dee2e6; padding: 6px; text-align: left; font-size: 0.85rem; max-width: 400px;" id="text-6hz">if you will give us your promise to meet captain battleax here at this time to morrow we will stretch a point and delay the departure of the john bright for twenty four hours</td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">FlexiCodec</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/flexicodec_6hz/00000_1q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/flexicodec_8hz/00000_1q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/flexicodec_12hz/00000_1q.wav" type="audio/wav">
                                </audio>
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">DualCodec</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dualcodec6hz/00000_1q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dualcodec8hz/00000_1q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dualcodec12hz/00000_1q.wav" type="audio/wav">
                                </audio>
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">DAC</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dac6hz/00000_1q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dac8hz/00000_1q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dac12hz/00000_1q.wav" type="audio/wav">
                                </audio>
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">GroundTruth</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dac6hz/00000_0q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dac8hz/00000_0q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dac12hz/00000_0q.wav" type="audio/wav">
                                </audio>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="demo-caption" style="margin-top: 10px; font-size: 0.9em; color: #666; text-align: justify;">
                Semantic reconstruction demos - Audio reconstructed using RVQ-1 tokens across some low frame rate settings .
            </div>
            <p>
                The audios above show that FlexiCodec audios are more intelligible than other codecs especially at lower frame rates like 6.25Hz. 
                This is confirmed by using a speech recognition to compute the WERs of the audios, as illustrated below. 
                <b>The rich semantic information of FlexiCodec RVQ-1 tokens is helpful for the downstream models</b> (especially the AR models) to generate more intlligible speech.
            </p>
            

            <figure style="margin: 20px auto; width: 50%; max-width: 600px;" id="fig-rvq1-chart">
                <img src="rvq1chart.png" alt="RVQ1 Chart Analysis" style="width: 100%; height: auto; border: 1px solid #ddd; border-radius: 8px;">
                <figcaption style="margin-top: 10px; text-align: center;">
                    Quantitative analysis of RVQ-1 token performance across different frame rates and codec architectures.
                </figcaption>
            </figure>

            <h3>Acoustic Quality Evaluation</h3>
            <p>
                Audio codecs can use more RVQ layers to reconstruct acoustic details. 
                The following audios are reconstructed audios using 8 RVQ layers for each codec variant.
                You may not easily hear the difference, 
                so we attach a figure of the PESQ metric.
                <!-- The acoustic quality metrics show more moderate differences across systems and frame rates. 
                As shown in the acoustic evaluation tables below, the PESQ, MCD, SIM, and UTMOS metrics show that at each frame rate, FlexiCodec slightly outperforms DualCodec, followed by a larger gap with DAC. 
                We observe that the gap between models does not substantially increase when changing to lower frame rates, but has been seen in the semantic testing. 
                We think that the acoustic fidelity is more constrained by bitrate, and because the bitrates of the three systems are at the same level, the difference is not pronounced. -->
            </p>
            <!-- <div style="margin-bottom: 10px; text-align: center; margin-top: 30px;">
                <button id="toggle-frame-rate-8q-text-btn" onclick="toggleFrameRate8QText()" style="padding: 8px 16px; background-color: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9rem; margin-bottom: 10px;">
                    üìù Hide Reference Text
                </button>
            </div> -->
            
            <div style="margin-bottom: 15px; text-align: center;">
                <div style="display: inline-flex; flex-wrap: wrap; justify-content: center; background-color: #f8f9fa; border-radius: 6px; padding: 3px; gap: 1px;">
                    <button class="sample-8q-btn active" onclick="switch8QSample(1)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: #4285f4; color: white; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 1</button>
                    <button class="sample-8q-btn" onclick="switch8QSample(2)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 2</button>
                    <button class="sample-8q-btn" onclick="switch8QSample(3)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 3</button>
                    <button class="sample-8q-btn" onclick="switch8QSample(4)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 4</button>
                    <button class="sample-8q-btn" onclick="switch8QSample(5)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 5</button>
                    <button class="sample-8q-btn" onclick="switch8QSample(6)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 6</button>
                    <button class="sample-8q-btn" onclick="switch8QSample(7)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 7</button>
                    <button class="sample-8q-btn" onclick="switch8QSample(8)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 8</button>
                    <button class="sample-8q-btn" onclick="switch8QSample(9)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 9</button>
                    <button class="sample-8q-btn" onclick="switch8QSample(10)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 10</button>
                </div>
            </div>
            
            <div class="table-responsive" id="frame-rate-comparison-8q">
                <table class="frame-rate-table" style="width: 100%; border-collapse: collapse; margin: 10px 0;">
                    <thead>
                        <tr>
                            <th style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: 600; min-width: 100px; font-size: 0.9rem;">Model</th>
                            <th style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: 600; min-width: 160px; font-size: 0.9rem;">6.25Hz (RVQ1:8)</th>
                            <th style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: 600; min-width: 160px; font-size: 0.9rem;">8.3Hz (RVQ1:8)</th>
                            <th style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: 600; min-width: 160px; font-size: 0.9rem;">12.5Hz (RVQ1:8)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="frame-rate-8q-text-row" style="display: table-row;">
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">Reference Text</td>
                            <td colspan="3" style="border: 1px solid #dee2e6; padding: 6px; text-align: left; font-size: 0.85rem; max-width: 400px;" id="text-8q-6hz">if you will give us your promise to meet captain battleax here at this time to morrow we will stretch a point and delay the departure of the john bright for twenty four hours</td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">FlexiCodec</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-8q-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/flexicodec_6hz/00000_8q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-8q-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/flexicodec_8hz/00000_8q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-8q-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/flexicodec_12hz/00000_8q.wav" type="audio/wav">
                                </audio>
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">DualCodec</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-8q-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dualcodec6hz/00000_8q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-8q-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dualcodec8hz/00000_8q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-8q-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dualcodec12hz/00000_8q.wav" type="audio/wav">
                                </audio>
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">DAC</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-8q-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dac6hz/00000_8q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-8q-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dac8hz/00000_8q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-8q-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dac12hz/00000_8q.wav" type="audio/wav">
                                </audio>
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">GroundTruth</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-8q-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dac6hz/00000_0q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-8q-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dac8hz/00000_0q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="sample-8q-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dac12hz/00000_0q.wav" type="audio/wav">
                                </audio>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="demo-caption" style="margin-top: 10px; font-size: 0.9em; color: #666; text-align: justify;">
                Audio reconstruction quality across different frame rates using RVQ-1:8 tokens.
            </div>
            
            <figure style="margin: 20px auto; width: 50%; max-width: 600px;" id="fig-rvq8-chart">
                <img src="rvq8chart.png" alt="RVQ8 Chart Analysis" style="width: 100%; height: auto; border: 1px solid #ddd; border-radius: 8px;">
                <figcaption style="margin-top: 10px; text-align: center;">
                    Quantitative analysis of RVQ-8 token performance across different frame rates and codec architectures.
                </figcaption>
            </figure>
            
            <p style="margin-top: 20px;">
                The results show that acoustic quality metrics show more moderate differences across systems and frame rates, compared to the dramatic differences in the previous semantic evaluation.
                We think that the acoustic fidelity is more constrained by bitrate, and because the bitrates of the three systems are at the same level, the difference is not pronounced.

            </p>

            <h3 id="speech-codec-comparison">Additional Codec-Reconstructed Audio Comparisons</h3>
            <p>
                The following audio comparisons showcase the quality differences between FlexiCodec and other open-source codec systems. 
                These samples demonstrate how FlexiCodec performs compared to established codec architectures at different compression rates.
            </p>
            
            <!-- <div style="margin-bottom: 10px; text-align: center;">
                <button id="toggle-codec-comparison-text-btn" onclick="toggleCodecComparisonText()" style="padding: 8px 16px; background-color: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9rem; margin-bottom: 10px;">
                    üìù Hide Reference Text
                </button>
            </div> -->
            
            <div style="margin-bottom: 15px; text-align: center;">
                <div style="display: inline-flex; flex-wrap: wrap; justify-content: center; background-color: #f8f9fa; border-radius: 6px; padding: 3px; gap: 1px;">
                    <button class="codec-sample-btn active" onclick="switchCodecSample(1)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: #4285f4; color: white; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 1</button>
                    <button class="codec-sample-btn" onclick="switchCodecSample(2)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 2</button>
                    <button class="codec-sample-btn" onclick="switchCodecSample(3)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 3</button>
                    <button class="codec-sample-btn" onclick="switchCodecSample(4)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 4</button>
                    <button class="codec-sample-btn" onclick="switchCodecSample(5)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 5</button>
                    <button class="codec-sample-btn" onclick="switchCodecSample(6)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 6</button>
                    <button class="codec-sample-btn" onclick="switchCodecSample(7)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 7</button>
                    <button class="codec-sample-btn" onclick="switchCodecSample(8)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 8</button>
                    <button class="codec-sample-btn" onclick="switchCodecSample(9)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 9</button>
                    <button class="codec-sample-btn" onclick="switchCodecSample(10)" style="padding: 6px 12px; border: none; border-radius: 4px; background-color: transparent; color: #666; cursor: pointer; font-weight: 500; font-size: 0.9rem;">Sample 10</button>
                </div>
            </div>
            
            <div class="table-responsive" id="codec-audio-comparison">
                <table class="frame-rate-table" style="width: 100%; border-collapse: collapse; margin: 10px 0;">
                    <thead>
                        <tr>
                            <th style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: 600; min-width: 100px; font-size: 0.9rem;">System</th>
                            <th style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: 600; min-width: 160px; font-size: 0.9rem;">RVQ1:8</th>
                            <th style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: 600; min-width: 160px; font-size: 0.9rem;">RVQ1</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="codec-comparison-text-row" style="display: table-row;">
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">Reference Text</td>
                            <td colspan="2" style="border: 1px solid #dee2e6; padding: 6px; text-align: left; font-size: 0.85rem; max-width: 400px;" id="codec-comparison-text">if you will give us your promise to meet captain battleax here at this time to morrow we will stretch a point and delay the departure of the john bright for twenty four hours</td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">FlexiCodec@12.5Hz</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/flexicodec_12hz/00000_8q.wav" type="audio/wav">
                                </audio><br>(1.3kbps)
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/flexicodec_12hz/00000_1q.wav" type="audio/wav">
                                </audio><br>(0.23kbps)
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">FlexiCodec@8.3Hz</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/flexicodec_8hz/00000_8q.wav" type="audio/wav">
                                </audio><br>(0.85kbps)
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/flexicodec_8hz/00000_1q.wav" type="audio/wav">
                                </audio><br>(0.15kbps)
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">FlexiCodec@6.25Hz</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/flexicodec_6hz/00000_8q.wav" type="audio/wav">
                                </audio><br>(0.64kbps)
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/flexicodec_6hz/00000_1q.wav" type="audio/wav">
                                </audio><br>(0.11kbps)
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">GroundTruth</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="other_codec_audios/official_encodec/00000_0q.wav" type="audio/wav">
                                </audio>
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="other_codec_audios/official_encodec/00000_0q.wav" type="audio/wav">
                                </audio>
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">Encodec</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="other_codec_audios/official_encodec/00000_8q.wav" type="audio/wav">
                                </audio><br>(6kbps)
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="other_codec_audios/official_encodec/00000_2q.wav" type="audio/wav">
                                </audio><br>(1.5kbps)
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">Mimi</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="other_codec_audios/official_mimi/00000_8q.wav" type="audio/wav">
                                </audio><br>(1.1kbps)
                                <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">N/A
                            </td>
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">SNAC</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="other_codec_audios/official_snac/00000_4q.wav" type="audio/wav">
                                </audio><br>(0.98kbps)
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">N/A
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">XCodec2</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="other_codec_audios/official_xcodec2/00000_1q.wav" type="audio/wav">
                                </audio><br>(0.8kbps)
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">Same as left
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">XYTokenizer</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="other_codec_audios/official_xytokenizer/00000_8q.wav" type="audio/wav">
                                </audio><br>(1.0kbps)
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                N/A
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">DualCodec-12.5Hz</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dualcodec12hz/00000_8q.wav" type="audio/wav">
                                </audio><br>(1.2kbps)
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="impact_of_low_frame_rate/dualcodec12hz/00000_1q.wav" type="audio/wav">
                                </audio><br>(0.19kbps)
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">SpeechTokenizer</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="other_codec_audios/speechtokenizerofficial/00000_8q.wav" type="audio/wav">
                                </audio><br>(4.0kbps)
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="other_codec_audios/speechtokenizerofficial/00000_1q.wav" type="audio/wav">
                                </audio><br>(0.5kbps)
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">TaDiCodec</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="other_codec_audios/tadicodec/00000_1q.wav" type="audio/wav">
                                </audio><br>(>0.15kbps, uses additional <br> reference audio)
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">same as left
                            </td>
                        </tr>
                        <tr>
                            <td style="background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 4px; text-align: center; font-weight: 500; font-size: 0.9rem;">WavTokenizer</td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                <audio controls preload="none" class="codec-sample-audio" data-sample="1" style="width: 140px; height: 32px;">
                                    <source src="other_codec_audios/wavtokenizerofficial/00000_1q.wav" type="audio/wav">
                                </audio><br>(0.90kbps)
                            </td>
                            <td style="border: 1px solid #dee2e6; padding: 4px; text-align: center;">
                                same as left
                            </td>
                        </tr>
                        
                    </tbody>
                </table>
            </div>
            
            <div class="demo-caption" style="margin-top: 10px; font-size: 0.9em; color: #666; text-align: justify;">
                Codec reconstructed audio comparison. 
            </div>


            <div>
                We have compared Flexi-Codec with open-source neural audio codecs, spanning various bitrate and frame rates. We find that FlexiCodec has state-of-the-art acoustic quality (RVQ1:8) and semantic preservation (RVQ1) at various bitrate levels. 
                And it is competitive to higher frame rate systems, such as SpeechTokenizer-50Hz, Encodec-75Hz, WavTokenizer-75Hz, etc.
            </div>
            <div id="table-codec-comparison">
                <table class="codec-table">
                    <thead>
                        <tr>
                            <th rowspan="2" style="min-width: 140px;">System</th>
                            <th rowspan="2">RVQ1<br/>BR(kbps)</th>
                            <th rowspan="2">RVQ1:8<br/>BR(kbps)/n_q</th>
                            <th rowspan="2">Param</th>
                            <th colspan="2" style="border-right: 2px solid #dee2e6;">Semantic Test</th>
                            <th colspan="4">Acoustic Test (RVQ1:8)</th>
                        </tr>
                        <tr>
                            <th>WER(RVQ1)‚Üì</th>
                            <th style="border-right: 2px solid #dee2e6;">WER(RVQ1:8)‚Üì</th>
                            <th>PESQ‚Üë</th>
                            <th>UTMOS‚Üë</th>
                            <th>MCD‚Üì</th>
                            <th>SIM‚Üë</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="10" style="background-color: #f0f0f0; text-align: center; font-weight: bold; font-style: italic;">>&thinsp;1kbps Acoustic Bitrate</td>
                        </tr>
                        <tr>
                            <td>DAC-75Hz</td>
                            <td>0.75</td>
                            <td>6.0 / 8q</td>
                            <td>74M</td>
                            <td>31.2</td>
                            <td style="border-right: 2px solid #dee2e6;">2.27</td>
                            <td><strong>3.77</strong></td>
                            <td>3.62</td>
                            <td>2.34</td>
                            <td><strong>0.90</strong></td>
                        </tr>
                        <tr>
                            <td>Encodec-75Hz</td>
                            <td>1.50</td>
                            <td>6.0 / 8q</td>
                            <td>15M</td>
                            <td>5.90</td>
                            <td style="border-right: 2px solid #dee2e6;">2.24</td>
                            <td>3.12</td>
                            <td>3.01</td>
                            <td>2.60</td>
                            <td>0.89</td>
                        </tr>
                        <tr>
                            <td>SpeechTokenizer-50Hz</td>
                            <td>0.50</td>
                            <td>4.0 / 8q</td>
                            <td>103M</td>
                            <td>5.56</td>
                            <td style="border-right: 2px solid #dee2e6;">2.47</td>
                            <td>3.01</td>
                            <td>3.90</td>
                            <td>3.17</td>
                            <td>0.85</td>
                        </tr>
                        <tr>
                            <td>Mimi-12.5Hz</td>
                            <td>-</td>
                            <td>1.1 / 8q</td>
                            <td>78M</td>
                            <td>-</td>
                            <td style="border-right: 2px solid #dee2e6;">3.15</td>
                            <td>2.75</td>
                            <td>3.56</td>
                            <td>3.62</td>
                            <td>0.73</td>
                        </tr>
                        <tr>
                            <td>DualCodec-12.5Hz</td>
                            <td>0.19</td>
                            <td>1.2 / 8q</td>
                            <td>84M</td>
                            <td>5.93</td>
                            <td style="border-right: 2px solid #dee2e6;">2.26</td>
                            <td>3.29</td>
                            <td>4.18</td>
                            <td>2.81</td>
                            <td>0.85</td>
                        </tr>
                        <tr>
                            <td>XYTokenizer-12.5Hz</td>
                            <td>-</td>
                            <td>1.0 / 8q</td>
                            <td>520M</td>
                            <td>-</td>
                            <td style="border-right: 2px solid #dee2e6;">2.36</td>
                            <td>3.00</td>
                            <td>4.00</td>
                            <td>3.28</td>
                            <td>0.84</td>
                        </tr>
                        <tr>
                            <td><strong>FlexiCodec @12.5Hz</strong></td>
                            <td>0.23</td>
                            <td>1.3 / 8q</td>
                            <td>216M</td>
                            <td><strong>2.76</strong></td>
                            <td style="border-right: 2px solid #dee2e6;"><strong>2.23</strong></td>
                            <td>3.35</td>
                            <td><strong>4.22</strong></td>
                            <td><strong>2.76</strong></td>
                            <td>0.85</td>
                        </tr>
                        <tr>
                            <td colspan="10" style="background-color: #f0f0f0; text-align: center; font-weight: bold; font-style: italic;">‚àº0.8kbps Acoustic Bitrate</td>
                        </tr>
                        <tr>
                            <td>WavTokenizer-75Hz</td>
                            <td>0.90</td>
                            <td>0.90 / 1q</td>
                            <td>81M</td>
                            <td>4.57</td>
                            <td style="border-right: 2px solid #dee2e6;">4.57</td>
                            <td>2.86</td>
                            <td>3.98</td>
                            <td>3.51</td>
                            <td>0.68</td>
                        </tr>
                        <tr>
                            <td>SNAC-12,23,47Hz</td>
                            <td>-</td>
                            <td>0.98 / 3q</td>
                            <td>20M</td>
                            <td>-</td>
                            <td style="border-right: 2px solid #dee2e6;">4.21</td>
                            <td>2.51</td>
                            <td>3.43</td>
                            <td>3.61</td>
                            <td>0.67</td>
                        </tr>
                        <tr>
                            <td>XCodec2-50Hz</td>
                            <td>0.80</td>
                            <td>0.80 / 1q</td>
                            <td>210M</td>
                            <td><strong>2.80</strong></td>
                            <td style="border-right: 2px solid #dee2e6;"><strong>2.80</strong></td>
                            <td>2.77</td>
                            <td>4.08</td>
                            <td>3.65</td>
                            <td><strong>0.82</strong></td>
                        </tr>
                        <tr>
                            <td>TS3Codec(X2)-50Hz</td>
                            <td>0.85</td>
                            <td>0.85 / 1q</td>
                            <td>204M</td>
                            <td>4.09</td>
                            <td style="border-right: 2px solid #dee2e6;">4.09</td>
                            <td>2.80</td>
                            <td>3.80</td>
                            <td>3.38</td>
                            <td>0.68</td>
                        </tr>
                        <tr>
                            <td><strong>FlexiCodec @8.3Hz</strong></td>
                            <td>0.15</td>
                            <td>0.85 / 8q</td>
                            <td>216M</td>
                            <td>2.98</td>
                            <td style="border-right: 2px solid #dee2e6;">2.28</td>
                            <td><strong>3.03</strong></td>
                            <td><strong>4.21</strong></td>
                            <td><strong>3.10</strong></td>
                            <td>0.78</td>
                        </tr>
                        <tr>
                            <td colspan="10" style="background-color: #f0f0f0; text-align: center; font-weight: bold; font-style: italic;"><0.7kbps Acoustic Bitrate</td>
                        </tr>
                        <tr>
                            <td>TS3Codec(X4)-40Hz</td>
                            <td>0.68</td>
                            <td>0.68 / 1q</td>
                            <td>204M</td>
                            <td>5.14</td>
                            <td style="border-right: 2px solid #dee2e6;">5.14</td>
                            <td>2.58</td>
                            <td>3.67</td>
                            <td>3.65</td>
                            <td>0.63</td>
                        </tr>
                        <tr>
                            <td>TaDiCodec-6.25Hz</td>
                            <td>0.15</td>
                            <td>0.15 / 1q</td>
                            <td>751M</td>
                            <td>4.32</td>
                            <td style="border-right: 2px solid #dee2e6;">4.32</td>
                            <td>1.73</td>
                            <td>4.05</td>
                            <td>9.75</td>
                            <td><strong>0.83</strong></td>
                        </tr>
                        <tr>
                            <td><strong>FlexiCodec @6.25Hz</strong></td>
                            <td>0.11</td>
                            <td>0.64 / 8q</td>
                            <td>216M</td>
                            <td><strong>4.15</strong></td>
                            <td style="border-right: 2px solid #dee2e6;"><strong>2.53</strong></td>
                            <td><strong>2.76</strong></td>
                            <td><strong>4.18</strong></td>
                            <td><strong>3.42</strong></td>
                            <td>0.71</td>
                        </tr>
                    </tbody>
                <!-- </table> -->
                </table>
            </div>
            
            <div class="table-caption" style="margin-top: 10px; font-size: 0.9em; color: #666; text-align: justify;">
                Comparison between FlexiCodec and other open-source neural audio codecs. 
            </div>




            <h2>Text-to-Speech</h2>
            <p>
We built a text-to-speech system with FlexiCodec. This system is an AR + NAR(flow matching) TTS.
The AR predicts each FlexiCodec token and its frame length using two parallel prediction heads.
Because the AR model is usually the slowest part in TTS, it can greatly benefit from FlexiCodec's low frame rate.
For the NAR, we tried two schemes, one is using the 50Hz male spectrogram feature, the second one is using the 12.5Hz FlexiCodec feature.
            </p>

            <div style="margin-bottom: 10px; text-align: center;">
                <button id="toggle-text-btn" onclick="toggleReferenceText()" style="padding: 8px 16px; background-color: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9rem;">
                    üìù Hide Reference Text
                </button>
            </div>
            
            <div class="table-responsive pt-3" id="demo-tts-general">
                <table class="table table-hover pt-2 audio-comparison-table">
                    <thead>
                        <tr>
                            <th style="text-align: center; vertical-align: middle; "></th>
                            <th style="text-align: center; vertical-align: middle; ">Sample-1</th>
                            <th style="text-align: center; vertical-align: middle; ">Sample-2</th>
                            <th style="text-align: center; vertical-align: middle; ">Sample-3</th>
                            <th style="text-align: center; vertical-align: middle; ">Sample-4</th>
                            <th style="text-align: center; vertical-align: middle; ">Sample-5</th>
                            <th style="text-align: center; vertical-align: middle; ">Sample-6</th>
                            <th style="text-align: center; vertical-align: middle; ">Sample-7</th>
                            <th style="text-align: center; vertical-align: middle; ">Sample-8</th>
                            <th style="text-align: center; vertical-align: middle; ">Sample-9</th>
                            <th style="text-align: center; vertical-align: middle; ">Sample-10</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="reference-text-row" style="display: table-row;">
                            <td style="text-align: center; vertical-align: middle; min-width: 140px; padding: 0;"><strong>Reference Text</strong></td>
                            <td style="text-align: left; vertical-align: top; padding: 6px; max-width: 260px; white-space: normal;">Give me a check for a hundred and fifty, and I'll turn over to you the forged check and quash further proceedings.</td>
                            <td style="text-align: left; vertical-align: top; padding: 6px; max-width: 260px; white-space: normal;">I have been here this quarter of an hour," replied La Valliere.</td>
                            <td style="text-align: left; vertical-align: top; padding: 6px; max-width: 260px; white-space: normal;">What is the tumult and rioting"? cried out the Squire, authoritatively, and he blew twice on a silver whistle which hung at his belt.</td>
                            <td style="text-align: left; vertical-align: top; padding: 6px; max-width: 260px; white-space: normal;">You have come to us threatening us with absolute destruction.</td>
                            <td style="text-align: left; vertical-align: top; padding: 6px; max-width: 260px; white-space: normal;">The sound of an imperative and uncompromising bell recalled me in due time to the regions of reality.</td>
                            <td style="text-align: left; vertical-align: top; padding: 6px; max-width: 260px; white-space: normal;">He was soft hearted and impetuous," said Beth; "and, being in love, he didn't stop to count the cost".</td>
                            <td style="text-align: left; vertical-align: top; padding: 6px; max-width: 260px; white-space: normal;">The goat's warlike spirit was roused by this successful attack.</td>
                            <td style="text-align: left; vertical-align: top; padding: 6px; max-width: 260px; white-space: normal;">His conduct and presence of mind in this emergence appeared conspicuous.</td>
                            <td style="text-align: left; vertical-align: top; padding: 6px; max-width: 260px; white-space: normal;">The Nautilus nearly perishes in the Antarctic and Nemo sinks into a growing depression.</td>
                            <td style="text-align: left; vertical-align: top; padding: 6px; max-width: 260px; white-space: normal;">Jack would become Eva's happy husband, and would remain amidst the hurried duties of the eager world.</td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; min-width: 140px; padding: 0;"><strong>Ground Truth</strong></td>
                            <td><audio controls preload="none"><source src="tts_examples1/gt/00000.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/gt/00001.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/gt/00002.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/gt/00003.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/gt/00004.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/gt/00005.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/gt/00006.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/gt/00007.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/gt/00008.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/gt/00009.wav"></audio></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; min-width: 140px; padding: 0;"><strong>FlexiCodec-TTS (6.25Hz AR, 50Hz NAR)</strong></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzmel/Waves/GeneralSentence/00000.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzmel/Waves/GeneralSentence/00001.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzmel/Waves/GeneralSentence/00002.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzmel/Waves/GeneralSentence/00003.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzmel/Waves/GeneralSentence/00004.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzmel/Waves/GeneralSentence/00005.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzmel/Waves/GeneralSentence/00006.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzmel/Waves/GeneralSentence/00007.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzmel/Waves/GeneralSentence/00008.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzmel/Waves/GeneralSentence/00009.wav"></audio></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; min-width: 140px; padding: 0;"><strong>FlexiCodec-TTS (8.3Hz AR, 50Hz NAR)</strong></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzmel/Waves/GeneralSentence/00000.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzmel/Waves/GeneralSentence/00001.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzmel/Waves/GeneralSentence/00002.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzmel/Waves/GeneralSentence/00003.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzmel/Waves/GeneralSentence/00004.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzmel/Waves/GeneralSentence/00005.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzmel/Waves/GeneralSentence/00006.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzmel/Waves/GeneralSentence/00007.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzmel/Waves/GeneralSentence/00008.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzmel/Waves/GeneralSentence/00009.wav"></audio></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; min-width: 140px; padding: 0;"><strong>FlexiCodec-TTS (12.5Hz AR, 50Hz NAR)</strong></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzmel/Waves/GeneralSentence/00000.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzmel/Waves/GeneralSentence/00001.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzmel/Waves/GeneralSentence/00002.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzmel/Waves/GeneralSentence/00003.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzmel/Waves/GeneralSentence/00004.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzmel/Waves/GeneralSentence/00005.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzmel/Waves/GeneralSentence/00006.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzmel/Waves/GeneralSentence/00007.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzmel/Waves/GeneralSentence/00008.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzmel/Waves/GeneralSentence/00009.wav"></audio></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; min-width: 140px; padding: 0;"><strong>CosyVoice</strong></td>
                            <td><audio controls preload="none"><source src="tts_examples1/cosyvoice/Waves/GeneralSentence/00000.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/cosyvoice/Waves/GeneralSentence/00001.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/cosyvoice/Waves/GeneralSentence/00002.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/cosyvoice/Waves/GeneralSentence/00003.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/cosyvoice/Waves/GeneralSentence/00004.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/cosyvoice/Waves/GeneralSentence/00005.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/cosyvoice/Waves/GeneralSentence/00006.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/cosyvoice/Waves/GeneralSentence/00007.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/cosyvoice/Waves/GeneralSentence/00008.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/cosyvoice/Waves/GeneralSentence/00009.wav"></audio></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; min-width: 140px; padding: 0;"><strong>FlexiCodec-TTS (6.25Hz AR, 12.5Hz NAR)</strong></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzcodec/Waves/GeneralSentence/00000.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzcodec/Waves/GeneralSentence/00001.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzcodec/Waves/GeneralSentence/00002.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzcodec/Waves/GeneralSentence/00003.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzcodec/Waves/GeneralSentence/00004.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzcodec/Waves/GeneralSentence/00005.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzcodec/Waves/GeneralSentence/00006.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzcodec/Waves/GeneralSentence/00007.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzcodec/Waves/GeneralSentence/00008.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts6hzcodec/Waves/GeneralSentence/00009.wav"></audio></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; min-width: 140px; padding: 0;"><strong>FlexiCodec-TTS (8.3Hz AR, 12.5Hz NAR)</strong></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzcodec/Waves/GeneralSentence/00000.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzcodec/Waves/GeneralSentence/00001.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzcodec/Waves/GeneralSentence/00002.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzcodec/Waves/GeneralSentence/00003.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzcodec/Waves/GeneralSentence/00004.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzcodec/Waves/GeneralSentence/00005.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzcodec/Waves/GeneralSentence/00006.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzcodec/Waves/GeneralSentence/00007.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzcodec/Waves/GeneralSentence/00008.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts8hzcodec/Waves/GeneralSentence/00009.wav"></audio></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; min-width: 140px; padding: 0;"><strong>FlexiCodec-TTS (12.5Hz AR, 12.5Hz NAR)</strong></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzcodec/Waves/GeneralSentence/00000.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzcodec/Waves/GeneralSentence/00001.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzcodec/Waves/GeneralSentence/00002.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzcodec/Waves/GeneralSentence/00003.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzcodec/Waves/GeneralSentence/00004.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzcodec/Waves/GeneralSentence/00005.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzcodec/Waves/GeneralSentence/00006.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzcodec/Waves/GeneralSentence/00007.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzcodec/Waves/GeneralSentence/00008.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/tts12hzcodec/Waves/GeneralSentence/00009.wav"></audio></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; min-width: 140px; padding: 0;"><strong>SparkTTS</strong></td>
                            <td><audio controls preload="none"><source src="tts_examples1/sparktts/Waves/GeneralSentence/00000.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/sparktts/Waves/GeneralSentence/00001.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/sparktts/Waves/GeneralSentence/00002.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/sparktts/Waves/GeneralSentence/00003.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/sparktts/Waves/GeneralSentence/00004.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/sparktts/Waves/GeneralSentence/00005.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/sparktts/Waves/GeneralSentence/00006.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/sparktts/Waves/GeneralSentence/00007.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/sparktts/Waves/GeneralSentence/00008.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/sparktts/Waves/GeneralSentence/00009.wav"></audio></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; min-width: 140px; padding: 0;"><strong>FireRedTTS</strong></td>
                            <td><audio controls preload="none"><source src="tts_examples1/fireredtts/Waves/GeneralSentence/00000.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/fireredtts/Waves/GeneralSentence/00001.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/fireredtts/Waves/GeneralSentence/00002.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/fireredtts/Waves/GeneralSentence/00003.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/fireredtts/Waves/GeneralSentence/00004.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/fireredtts/Waves/GeneralSentence/00005.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/fireredtts/Waves/GeneralSentence/00006.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/fireredtts/Waves/GeneralSentence/00007.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/fireredtts/Waves/GeneralSentence/00008.wav"></audio></td>
                            <td><audio controls preload="none"><source src="tts_examples1/fireredtts/Waves/GeneralSentence/00009.wav"></audio></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="caption-container" style="color: #666; text-align: left;">
                <p class="demo-caption">
                    Text-to-Speech demos across models. Columns are different text samples.
                </p>
            </div>
            <p>We find that FlexiCodec-TTS delivers strong quality at less compute than baselines.
                With 6.25Hz AR + 50Hz NAR, it matches or surpasses CosyVoice and SparkTTS. 
                A 50Hz NAR consistently outperforms 12.5Hz across WER, SIM-0, NMOS, and QMOS, showing that higher temporal resolution is important for NAR.
                Lower AR rates (8.3/6.25Hz) preserve or slightly improve accuracy with 50Hz NAR‚Äîlikely due to better semantic-acoustic disentanglement and shorter sequences that simplify attention.
                </p>

            <h2 id="frame-rate-controllability">Frame rate controllability analysis</h2>
            <p>
                This section demonstrates FlexiCodec's frame rate controllability through different merging threshold settings. 
                The threshold parameter controls the dynamic frame rate mechanism, where lower thresholds lead to more aggressive frame merging and lower effective frame rates.
                <!-- Each row shows results for a different threshold value, allowing you to hear how frame rate controllability affects audio quality across different samples. -->
                As can be heard from the audios. the intelligibility is adequate at > 4.5Hz, but becomes unusable for 3.6Hz and 3.0Hz.
                <!-- At very low average frame such as 3.0 and 3.6Hz, the intelligibility is very poor. -->
            </p>

            <div style="margin-bottom: 10px; text-align: center;">
                <button id="toggle-threshold-text-btn" onclick="toggleThresholdReferenceText()" style="padding: 8px 16px; background-color: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9rem;">
                    üìù Hide Reference Text
                </button>
            </div>
            
            <div class="table-responsive pt-3" id="threshold-analysis-table">
                <table class="table table-hover pt-2 audio-comparison-table">
                    <thead>
                        <tr>
                            <th style="text-align: center; vertical-align: middle; min-width: 120px;">Threshold / Avg frame rate</th>
                            <th style="text-align: center; vertical-align: middle;">Sample 1</th>
                            <th style="text-align: center; vertical-align: middle;">Sample 2</th>
                            <th style="text-align: center; vertical-align: middle;">Sample 3</th>
                            <th style="text-align: center; vertical-align: middle;">Sample 4</th>
                            <th style="text-align: center; vertical-align: middle;">Sample 5</th>
                            <th style="text-align: center; vertical-align: middle;">Sample 6</th>
                            <th style="text-align: center; vertical-align: middle;">Sample 7</th>
                            <th style="text-align: center; vertical-align: middle;">Sample 8</th>
                            <th style="text-align: center; vertical-align: middle;">Sample 9</th>
                            <th style="text-align: center; vertical-align: middle;">Sample 10</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="threshold-reference-text-row" style="display: table-row;">
                            <td style="text-align: center; vertical-align: middle; font-weight: bold;">Reference Text</td>
                            <td style="padding: 8px; font-size: 0.85rem; max-width: 200px; word-wrap: break-word;" id="threshold-text-1">you were quite right to say no ambrose began never smoke with john jago his cigars will poison you</td>
                            <td style="padding: 8px; font-size: 0.85rem; max-width: 200px; word-wrap: break-word;" id="threshold-text-2">paul declares that the false apostles were called or sent neither by men nor by man</td>
                            <td style="padding: 8px; font-size: 0.85rem; max-width: 200px; word-wrap: break-word;" id="threshold-text-3">his hat had a peaked crown and a flat brim and around the brim was a row of tiny golden bells that tinkled when he moved</td>
                            <td style="padding: 8px; font-size: 0.85rem; max-width: 200px; word-wrap: break-word;" id="threshold-text-4">i reside in the marais rue de douze portes</td>
                            <td style="padding: 8px; font-size: 0.85rem; max-width: 200px; word-wrap: break-word;" id="threshold-text-5">the utility of consumption as an evidence of wealth is to be classed as a derivative growth</td>
                            <td style="padding: 8px; font-size: 0.85rem; max-width: 200px; word-wrap: break-word;" id="threshold-text-6">and there's linen in the house as i could well spare you for i've got lots o sheeting and table clothing and towelling as isn't made up</td>
                            <td style="padding: 8px; font-size: 0.85rem; max-width: 200px; word-wrap: break-word;" id="threshold-text-7">but i wrestled with this fellow and do know that he played unfairly in the second bout</td>
                            <td style="padding: 8px; font-size: 0.85rem; max-width: 200px; word-wrap: break-word;" id="threshold-text-8">of course he reflected she always had that combination of something homely and sensible and something utterly wild and daft</td>
                            <td style="padding: 8px; font-size: 0.85rem; max-width: 200px; word-wrap: break-word;" id="threshold-text-9">to all these inquiries the count responded in the affirmative</td>
                            <td style="padding: 8px; font-size: 0.85rem; max-width: 200px; word-wrap: break-word;" id="threshold-text-10">yes something everything said rachel hurriedly looking frowningly at a flower which she was twirling in her fingers</td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; font-weight: bold;">1.00 (12.5Hz)</td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_1_0thres/00000_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_1_0thres/00001_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_1_0thres/00002_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_1_0thres/00003_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_1_0thres/00004_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_1_0thres/00005_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_1_0thres/00006_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_1_0thres/00007_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_1_0thres/00008_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_1_0thres/00009_1q.wav"></audio></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; font-weight: bold;">0.90 (7.9Hz)</td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_9thres/00000_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_9thres/00001_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_9thres/00002_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_9thres/00003_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_9thres/00004_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_9thres/00005_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_9thres/00006_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_9thres/00007_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_9thres/00008_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_9thres/00009_1q.wav"></audio></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; font-weight: bold;">0.80 (4.5Hz)</td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_80thres/00000_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_80thres/00001_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_80thres/00002_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_80thres/00003_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_80thres/00004_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_80thres/00005_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_80thres/00006_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_80thres/00007_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_80thres/00008_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_80thres/00009_1q.wav"></audio></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; font-weight: bold;">0.75 (3.6Hz)</td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_75thres/00000_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_75thres/00001_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_75thres/00002_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_75thres/00003_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_75thres/00004_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_75thres/00005_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_75thres/00006_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_75thres/00007_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_75thres/00008_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_75thres/00009_1q.wav"></audio></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; font-weight: bold;">0.70 (3.0Hz)</td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00000_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00001_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00002_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00003_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00004_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00005_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00006_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00007_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00008_1q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00009_1q.wav"></audio></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; vertical-align: middle; font-weight: bold;">Ground Truth</td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00000_0q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00001_0q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00002_0q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00003_0q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00004_0q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00005_0q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00006_0q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00007_0q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00008_0q.wav"></audio></td>
                            <td><audio controls preload="none"><source src="threshold_evaluations/flexcodec_0_70thres/00009_0q.wav"></audio></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="demo-caption" style="margin-top: 10px; font-size: 0.9em; color: #666; text-align: justify;">
                FlexiCodec-reconstructed RVQ-1 audios using different merging thresholds.
                Lower threshold values (0.7, 0.75, 0.8) result in more aggressive frame merging and lower effective frame rates, while higher thresholds (0.90, 1.0) 
                preserve more temporal detail.
            </div>


        </d-article>            
        <d-bibliography src="bibliography.bib"></d-bibliography>

    <!-- <distill-footer></distill-footer> -->

</body>